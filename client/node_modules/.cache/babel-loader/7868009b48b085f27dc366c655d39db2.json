{"ast":null,"code":"import _classCallCheck from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/cloudkibo/Kibo/miniapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{withAlert}from'react-alert';import{joinRoom,registerCallback}from'./socket';import callApi from'./global/callApi';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.state={number:'',text:'',incomingMessage:false,incomingMessagePayload:{}};_this.onNumberChange=_this.onNumberChange.bind(_assertThisInitialized(_this));_this.onTextChange=_this.onTextChange.bind(_assertThisInitialized(_this));_this.onReset=_this.onReset.bind(_assertThisInitialized(_this));_this.onSend=_this.onSend.bind(_assertThisInitialized(_this));_this.handleIncomingMessage=_this.handleIncomingMessage.bind(_assertThisInitialized(_this));joinRoom('7wi1i073s7in9c0visminiapp');registerCallback(_this.handleIncomingMessage);return _this;}_createClass(App,[{key:\"onNumberChange\",value:function onNumberChange(e){this.setState({number:e.target.value});}},{key:\"onTextChange\",value:function onTextChange(e){this.setState({text:e.target.value});}},{key:\"onReset\",value:function onReset(){this.setState({number:'',text:''});}},{key:\"onSend\",value:function onSend(){var _this2=this;// eslint-disable-next-line\nvar regexp=/\\+(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*(\\d{1,14})$/g;if(regexp.test(this.state.number)){callApi('twilio/sendMessage','post',{number:this.state.number,text:this.state.text}).then(function(response){if(response.status==='success'){_this2.onReset();_this2.props.alert.success(response.description);}else{_this2.props.alert.error(response.description);}}).catch(function(err){console.log('sendMessage error',err);_this2.props.alert.error('An unexpected error occured. Please try again later.');});}else{this.props.alert.error('Please provide a valid number of format E.164');}}},{key:\"handleIncomingMessage\",value:function handleIncomingMessage(payload){this.props.alert.info(\"A new message came from \".concat(payload.From));this.setState({incomingMessagePayload:payload,incomingMessage:true});}},{key:\"render\",value:function render(){return React.createElement(\"div\",{style:{padding:'20px'},className:\"container\"},React.createElement(\"h3\",null,\"Covid-19 Mini App\"),React.createElement(\"div\",{style:{marginTop:'35px'}}),React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-6\"},React.createElement(\"div\",{className:\"form-group row\"},React.createElement(\"label\",{className:\"col-sm-4 col-form-label\"},\"Recipient Number\"),React.createElement(\"div\",{className:\"col-sm-8\"},React.createElement(\"input\",{type:\"text\",className:\"form-control\",id:\"_input_number\",placeholder:\"Enter number here...\",value:this.state.number,onChange:this.onNumberChange}))),React.createElement(\"div\",{className:\"md-form\"},React.createElement(\"textarea\",{id:\"_text_area\",className:\"md-textarea form-control\",rows:\"3\",placeholder:\"Type your message here...\",value:this.state.text,onChange:this.onTextChange})),React.createElement(\"div\",{style:{padding:'20px 0px'}},React.createElement(\"button\",{style:{float:'right'},type:\"button\",className:\"btn btn-primary\",onClick:this.onSend,disabled:!this.state.number||!this.state.text},\"Send\"),React.createElement(\"button\",{style:{float:'right',marginRight:'10px'},type:\"button\",className:\"btn btn-light\",onClick:this.onReset,disabled:!this.state.number||!this.state.text},\"Reset\"))),this.state.incomingMessage&&React.createElement(\"div\",{className:\"col-6\"},React.createElement(\"div\",{className:\"alert alert-success\",role:\"alert\"},React.createElement(\"h4\",{className:\"alert-heading\"},\"Message from \",this.state.incomingMessagePayload.From),React.createElement(\"p\",null,this.state.incomingMessagePayload.Body),React.createElement(\"hr\",null),React.createElement(\"p\",{className:\"mb-0\"},\"Country: \",this.state.incomingMessagePayload.FromCountry),React.createElement(\"p\",{className:\"mb-0\"},\"City: \",this.state.incomingMessagePayload.FromCity),React.createElement(\"p\",{className:\"mb-0\"},\"State: \",this.state.incomingMessagePayload.FromState)))));}}]);return App;}(Component);export default withAlert()(App);","map":{"version":3,"sources":["/Users/cloudkibo/Kibo/miniapp/client/src/App.js"],"names":["React","Component","withAlert","joinRoom","registerCallback","callApi","App","props","state","number","text","incomingMessage","incomingMessagePayload","onNumberChange","bind","onTextChange","onReset","onSend","handleIncomingMessage","e","setState","target","value","regexp","test","then","response","status","alert","success","description","error","catch","err","console","log","payload","info","From","padding","marginTop","float","marginRight","Body","FromCountry","FromCity","FromState"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withAlert } from 'react-alert'\nimport { joinRoom, registerCallback } from './socket'\nimport callApi from './global/callApi'\n\nclass App extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      number: '',\n      text: '',\n      incomingMessage: false,\n      incomingMessagePayload: {}\n    }\n    this.onNumberChange = this.onNumberChange.bind(this)\n    this.onTextChange = this.onTextChange.bind(this)\n    this.onReset = this.onReset.bind(this)\n    this.onSend = this.onSend.bind(this)\n    this.handleIncomingMessage = this.handleIncomingMessage.bind(this)\n\n    joinRoom('7wi1i073s7in9c0visminiapp')\n    registerCallback(this.handleIncomingMessage)\n  }\n\n  onNumberChange (e) {\n    this.setState({number: e.target.value})\n  }\n\n  onTextChange (e) {\n    this.setState({text: e.target.value})\n  }\n\n  onReset () {\n    this.setState({number: '', text: ''})\n  }\n\n  onSend () {\n    // eslint-disable-next-line\n    const regexp = /\\+(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*(\\d{1,14})$/g\n    if (regexp.test(this.state.number)) {\n      callApi('twilio/sendMessage', 'post', {number: this.state.number, text: this.state.text})\n        .then(response => {\n          if (response.status === 'success') {\n            this.onReset()\n            this.props.alert.success(response.description)\n          } else {\n            this.props.alert.error(response.description)\n          }\n        })\n        .catch(err => {\n          console.log('sendMessage error', err)\n          this.props.alert.error('An unexpected error occured. Please try again later.')\n        })\n    } else {\n      this.props.alert.error('Please provide a valid number of format E.164')\n    }\n  }\n\n  handleIncomingMessage (payload) {\n    this.props.alert.info(`A new message came from ${payload.From}`)\n    this.setState({incomingMessagePayload: payload, incomingMessage: true})\n  }\n\n  render () {\n    return (\n      <div style={{padding: '20px'}} className=\"container\">\n        <h3>Covid-19 Mini App</h3>\n        <div style={{marginTop: '35px'}} />\n        <div className='row'>\n          <div className='col-6'>\n            <div className=\"form-group row\">\n              <label className=\"col-sm-4 col-form-label\">\n                Recipient Number\n              </label>\n              <div className=\"col-sm-8\">\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  id=\"_input_number\"\n                  placeholder='Enter number here...'\n                  value={this.state.number}\n                  onChange={this.onNumberChange}\n                />\n              </div>\n            </div>\n            <div className=\"md-form\">\n              <textarea\n                id=\"_text_area\"\n                className=\"md-textarea form-control\"\n                rows=\"3\"\n                placeholder='Type your message here...'\n                value={this.state.text}\n                onChange={this.onTextChange}\n              />\n            </div>\n            <div style={{padding: '20px 0px'}}>\n              <button\n                style={{float: 'right'}}\n                type=\"button\"\n                className=\"btn btn-primary\"\n                onClick={this.onSend}\n                disabled={!this.state.number || !this.state.text}\n              >\n                Send\n              </button>\n              <button\n                style={{float: 'right', marginRight: '10px'}}\n                type=\"button\"\n                className=\"btn btn-light\"\n                onClick={this.onReset}\n                disabled={!this.state.number || !this.state.text}\n              >\n                Reset\n              </button>\n            </div>\n          </div>\n          {\n            this.state.incomingMessage &&\n            <div className='col-6'>\n              <div className=\"alert alert-success\" role=\"alert\">\n                <h4 className=\"alert-heading\">Message from {this.state.incomingMessagePayload.From}</h4>\n                <p>{this.state.incomingMessagePayload.Body}</p>\n                <hr />\n                <p className=\"mb-0\">Country: {this.state.incomingMessagePayload.FromCountry}</p>\n                <p className=\"mb-0\">City: {this.state.incomingMessagePayload.FromCity}</p>\n                <p className=\"mb-0\">State: {this.state.incomingMessagePayload.FromState}</p>\n              </div>\n            </div>\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withAlert()(App)\n"]},"metadata":{},"sourceType":"module"}