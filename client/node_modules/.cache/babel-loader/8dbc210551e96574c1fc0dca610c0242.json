{"ast":null,"code":"var _jsxFileName = \"/Users/cloudkibo/Kibo/miniapp/client/src/App.js\";\nimport React, { Component } from 'react';\nimport { withAlert } from 'react-alert';\nimport { joinRoom, registerCallback } from './socket';\nimport callApi from './global/callApi';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      number: '',\n      text: '',\n      incomingMessage: false,\n      incomingMessagePayload: {}\n    };\n    this.onNumberChange = this.onNumberChange.bind(this);\n    this.onTextChange = this.onTextChange.bind(this);\n    this.onReset = this.onReset.bind(this);\n    this.onSend = this.onSend.bind(this);\n    this.handleIncomingMessage = this.handleIncomingMessage.bind(this);\n    joinRoom('7wi1i073s7in9c0visminiapp');\n    registerCallback(this.handleIncomingMessage);\n  }\n\n  onNumberChange(e) {\n    this.setState({\n      number: e.target.value\n    });\n  }\n\n  onTextChange(e) {\n    this.setState({\n      text: e.target.value\n    });\n  }\n\n  onReset() {\n    this.setState({\n      number: '',\n      text: ''\n    });\n  }\n\n  onSend() {\n    // eslint-disable-next-line\n    const regexp = /\\+(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*(\\d{1,14})$/g;\n\n    if (regexp.test(this.state.number)) {\n      this.onReset();\n      callApi('twilio/sendMessage', 'post', {\n        number: this.state.number,\n        text: this.state.text\n      }).then(response => {\n        if (response.status === 'success') {\n          this.props.alert.success(response.description);\n        } else {\n          this.props.alert.error(response.description);\n        }\n      }).catch(err => {\n        console.log('sendMessage error', err);\n        this.props.alert.error('An unexpected error occured. Please try again later.');\n      });\n    } else {\n      this.props.alert.error('Please provide a valid number of format E.164');\n    }\n  }\n\n  handleIncomingMessage(payload) {\n    this.props.alert.info(`A new message came from ${payload.From}`);\n    this.setState({\n      incomingMessagePayload: payload,\n      incomingMessage: true\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        padding: '20px'\n      },\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"Covis Mini App\"), React.createElement(\"div\", {\n      style: {\n        marginTop: '35px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"col-sm-4 col-form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"Recipient Number\"), React.createElement(\"div\", {\n      className: \"col-sm-8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      id: \"_input_number\",\n      placeholder: \"Enter number here...\",\n      value: this.state.number,\n      onChange: this.onNumberChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"md-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      id: \"_text_area\",\n      className: \"md-textarea form-control\",\n      rows: \"3\",\n      placeholder: \"Type your message here...\",\n      value: this.state.text,\n      onChange: this.onTextChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: {\n        padding: '20px 0px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      style: {\n        float: 'right'\n      },\n      type: \"button\",\n      className: \"btn btn-primary\",\n      onClick: this.onSend,\n      disabled: !this.state.number || !this.state.text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Send\"), React.createElement(\"button\", {\n      style: {\n        float: 'right',\n        marginRight: '10px'\n      },\n      type: \"button\",\n      className: \"btn btn-light\",\n      onClick: this.onReset,\n      disabled: !this.state.number || !this.state.text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Reset\"))), this.state.incomingMessage && React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"alert alert-success\",\n      role: \"alert\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"alert-heading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"Message from \", this.state.incomingMessagePayload.From), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, this.state.incomingMessagePayload.Body), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"mb-0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"Country: \", this.state.incomingMessagePayload.FromCountry)))));\n  }\n\n}\n\nexport default withAlert()(App);","map":{"version":3,"sources":["/Users/cloudkibo/Kibo/miniapp/client/src/App.js"],"names":["React","Component","withAlert","joinRoom","registerCallback","callApi","App","constructor","props","state","number","text","incomingMessage","incomingMessagePayload","onNumberChange","bind","onTextChange","onReset","onSend","handleIncomingMessage","e","setState","target","value","regexp","test","then","response","status","alert","success","description","error","catch","err","console","log","payload","info","From","render","padding","marginTop","float","marginRight","Body","FromCountry"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withAlert } from 'react-alert'\nimport { joinRoom, registerCallback } from './socket'\nimport callApi from './global/callApi'\n\nclass App extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      number: '',\n      text: '',\n      incomingMessage: false,\n      incomingMessagePayload: {}\n    }\n    this.onNumberChange = this.onNumberChange.bind(this)\n    this.onTextChange = this.onTextChange.bind(this)\n    this.onReset = this.onReset.bind(this)\n    this.onSend = this.onSend.bind(this)\n    this.handleIncomingMessage = this.handleIncomingMessage.bind(this)\n\n    joinRoom('7wi1i073s7in9c0visminiapp')\n    registerCallback(this.handleIncomingMessage)\n  }\n\n  onNumberChange (e) {\n    this.setState({number: e.target.value})\n  }\n\n  onTextChange (e) {\n    this.setState({text: e.target.value})\n  }\n\n  onReset () {\n    this.setState({number: '', text: ''})\n  }\n\n  onSend () {\n    // eslint-disable-next-line\n    const regexp = /\\+(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*\\d\\W*(\\d{1,14})$/g\n    if (regexp.test(this.state.number)) {\n      this.onReset()\n      callApi('twilio/sendMessage', 'post', {number: this.state.number, text: this.state.text})\n        .then(response => {\n          if (response.status === 'success') {\n            this.props.alert.success(response.description)\n          } else {\n            this.props.alert.error(response.description)\n          }\n        })\n        .catch(err => {\n          console.log('sendMessage error', err)\n          this.props.alert.error('An unexpected error occured. Please try again later.')\n        })\n    } else {\n      this.props.alert.error('Please provide a valid number of format E.164')\n    }\n  }\n\n  handleIncomingMessage (payload) {\n    this.props.alert.info(`A new message came from ${payload.From}`)\n    this.setState({incomingMessagePayload: payload, incomingMessage: true})\n  }\n\n  render () {\n    return (\n      <div style={{padding: '20px'}} className=\"container\">\n        <h3>Covis Mini App</h3>\n        <div style={{marginTop: '35px'}} />\n        <div className='row'>\n          <div className='col-6'>\n            <div className=\"form-group row\">\n              <label className=\"col-sm-4 col-form-label\">\n                Recipient Number\n              </label>\n              <div className=\"col-sm-8\">\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  id=\"_input_number\"\n                  placeholder='Enter number here...'\n                  value={this.state.number}\n                  onChange={this.onNumberChange}\n                />\n              </div>\n            </div>\n            <div className=\"md-form\">\n              <textarea\n                id=\"_text_area\"\n                className=\"md-textarea form-control\"\n                rows=\"3\"\n                placeholder='Type your message here...'\n                value={this.state.text}\n                onChange={this.onTextChange}\n              />\n            </div>\n            <div style={{padding: '20px 0px'}}>\n              <button\n                style={{float: 'right'}}\n                type=\"button\"\n                className=\"btn btn-primary\"\n                onClick={this.onSend}\n                disabled={!this.state.number || !this.state.text}\n              >\n                Send\n              </button>\n              <button\n                style={{float: 'right', marginRight: '10px'}}\n                type=\"button\"\n                className=\"btn btn-light\"\n                onClick={this.onReset}\n                disabled={!this.state.number || !this.state.text}\n              >\n                Reset\n              </button>\n            </div>\n          </div>\n          {\n            this.state.incomingMessage &&\n            <div className='col-6'>\n              <div className=\"alert alert-success\" role=\"alert\">\n                <h4 className=\"alert-heading\">Message from {this.state.incomingMessagePayload.From}</h4>\n                <p>{this.state.incomingMessagePayload.Body}</p>\n                <hr />\n                <p className=\"mb-0\">Country: {this.state.incomingMessagePayload.FromCountry}</p>\n              </div>\n            </div>\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withAlert()(App)\n"]},"metadata":{},"sourceType":"module"}